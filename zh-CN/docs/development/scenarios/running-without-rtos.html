<!doctype html>
<html class="docs-version-current" lang="zh-CN" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="search" type="application/opensearchdescription+xml" title="TouchGFX Documentation" href="/4.19/zh-CN/opensearch.xml">
<script src="/4.19/js/fix-location.js"></script><title data-react-helmet="true">Running without an RTOS on a TouchGFX Board Setup | TouchGFX Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://support.touchgfx.com/4.19/zh-CN/img/meta-image.png"><meta data-react-helmet="true" name="twitter:image" content="https://support.touchgfx.com/4.19/zh-CN/img/meta-image.png"><meta data-react-helmet="true" property="og:url" content="https://support.touchgfx.com/4.19/zh-CN/docs/development/scenarios/running-without-rtos"><meta data-react-helmet="true" name="docsearch:language" content="zh-CN"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Running without an RTOS on a TouchGFX Board Setup | TouchGFX Documentation"><meta data-react-helmet="true" name="description" content="In this section we will discuss how to run a TouchGFX project without an operating system based on a TouchGFX Board Setup for one of the ST development kits available in TouchGFX Designer. This article is not aimed for custom projects started from STM32CubeMX or STM32CubeIDE."><meta data-react-helmet="true" property="og:description" content="In this section we will discuss how to run a TouchGFX project without an operating system based on a TouchGFX Board Setup for one of the ST development kits available in TouchGFX Designer. This article is not aimed for custom projects started from STM32CubeMX or STM32CubeIDE."><link data-react-helmet="true" rel="shortcut icon" href="/4.19/zh-CN/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://support.touchgfx.com/4.19/zh-CN/docs/development/scenarios/running-without-rtos"><link data-react-helmet="true" rel="alternate" href="https://support.touchgfx.com/4.19/docs/development/scenarios/running-without-rtos" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://support.touchgfx.com/4.19/ko/docs/development/scenarios/running-without-rtos" hreflang="ko"><link data-react-helmet="true" rel="alternate" href="https://support.touchgfx.com/4.19/ja/docs/development/scenarios/running-without-rtos" hreflang="ja"><link data-react-helmet="true" rel="alternate" href="https://support.touchgfx.com/4.19/zh-CN/docs/development/scenarios/running-without-rtos" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://support.touchgfx.com/4.19/zh-TW/docs/development/scenarios/running-without-rtos" hreflang="zh-TW"><link data-react-helmet="true" rel="alternate" href="https://support.touchgfx.com/4.19/docs/development/scenarios/running-without-rtos" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://B8LNOI0XWD-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/4.19/zh-CN/assets/css/styles.321a00f7.css">
<link rel="preload" href="/4.19/zh-CN/assets/js/runtime~main.72940727.js" as="script">
<link rel="preload" href="/4.19/zh-CN/assets/js/main.f67cdb5d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/4.19/zh-CN/docs/introduction/welcome"><div class="navbar__logo"><img src="/4.19/zh-CN/img/logo.svg" alt="TouchGFX" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/4.19/zh-CN/img/logo.svg" alt="TouchGFX" class="themedImage_1VuW themedImage--dark_hz6m"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link"><span><span>简体中文</span></span></a><ul class="dropdown__menu"><li><a href="/4.19/docs/development/scenarios/running-without-rtos" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/4.19/ko/docs/development/scenarios/running-without-rtos" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">한국어</a></li><li><a href="/4.19/ja/docs/development/scenarios/running-without-rtos" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">日本語</a></li><li><a href="/4.19/zh-CN/docs/development/scenarios/running-without-rtos" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">简体中文</a></li><li><a href="/4.19/zh-TW/docs/development/scenarios/running-without-rtos" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">繁體中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/4.19/zh-CN/docs/introduction/welcome">4.19</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/4.19/zh-CN/docs/development/scenarios/running-without-rtos">4.19</a></li><li><a href="https://support.touchgfx.com/4.18" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>4.18<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://support.touchgfx.com/4.17" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>4.17<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://support.touchgfx.com/4.16" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>4.16<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://support.touchgfx.com/4.15" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>4.15<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://support.touchgfx.com/4.14" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>4.14<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://support.touchgfx.com/4.13" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>4.13<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><a href="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community</a><a href="https://touchgfx.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">TouchGFX.com</a><div class="searchBox_1ZXk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Basic Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Development</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/4.19/zh-CN/docs/development/development-introduction">开发简介</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Hardware Selection</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Board Bring Up</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">TouchGFX AL Development</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">UI Development</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Scenarios</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.19/zh-CN/docs/development/scenarios/touchgfx-on-lowcost-hardware">低成本硬件上的TouchGFX</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.19/zh-CN/docs/development/scenarios/lowering-memory-usage-with-partial-framebuffer">Lowering Memory Usage with Partial Framebuffer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.19/zh-CN/docs/development/scenarios/using-non-memory-mapped-flash">使用非内存映射闪存存储图像</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.19/zh-CN/docs/development/scenarios/using-serial-flash">使用串行闪存存储图像和字体</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.19/zh-CN/docs/development/scenarios/fonts-in-unmapped-flash">使用非内存映射闪存存储字体数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.19/zh-CN/docs/development/scenarios/scenarios-change-pixelformat-bpp">更改应用的像素格式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.19/zh-CN/docs/development/scenarios/scenarios-create-at">创建TouchGFX应用模板</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.19/zh-CN/docs/development/scenarios/example-gpio">外部事件作为触发器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/4.19/zh-CN/docs/development/scenarios/running-without-rtos">Running without an RTOS on a TouchGFX Board Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/4.19/zh-CN/docs/development/scenarios/adding-files-to-stm32cubemx-projet">Adding files to STM32CubeMX project</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Miscellaneous</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorials</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Resources</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Running without an RTOS on a TouchGFX Board Setup</h1></header><p>In this section we will discuss how to run a TouchGFX project without an operating system based on a TouchGFX Board Setup for one of the ST development kits available in TouchGFX Designer. This article is not aimed for custom projects started from STM32CubeMX or STM32CubeIDE.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="starting-a-project-from-a-touchgfx-board-setup">Starting a project from a TouchGFX Board Setup<a aria-hidden="true" class="hash-link" href="#starting-a-project-from-a-touchgfx-board-setup" title="Direct link to heading">​</a></h2><p>On most of the TouchGFX Board Setups available in TouchGFX Designer the OS FreeRTOS is enabled by default. To run without an operating system a few steps must be followed. Here we will use the TouchGFX Board Setup for the STM32H7B3-DK board as an example.</p><ol><li><p>Create a project from TouchGFX Designer with the TouchGFX Board Setup for the STM32H7B3-DK board and generate code.</p></li><li><p>Open the provided <code>.ioc</code> file with STM32CubeMX.</p></li><li><p>In the STM32CubeMX interface, navigate to the <em>Middleware</em> -&gt; <em>FreeRTOS</em> settings and disable FreeRTOS</p></li></ol><div class="figure"><a href="/4.19/zh-CN/img/development/scenarios/running-without-rtos/disable-freertos-stm32cubemx-417.png" target="_blank"><img src="/4.19/zh-CN/img/development/scenarios/running-without-rtos/disable-freertos-stm32cubemx-417.png"></a><p>FreeRTOS settings in STM32CubeMX for the STM32H7B3-DK</p></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="turning-on-the-backlight">Turning on the backlight<a aria-hidden="true" class="hash-link" href="#turning-on-the-backlight" title="Direct link to heading">​</a></h3><p>The backlight on the displays are initially turned OFF in most of the TouchGFX Board Setups. This was done to prevent having a glitched display when booting up the board at the first tick. The backlight is then turned ON when the first framebuffer is ready in the <code>taskEntry()</code> function in <code>TouchGFXHAL.cpp</code> ( under the <code>TouchGFX/target</code> folder). When running without an OS the <code>taskEntry()</code> function is never called, meaning that the display will never be turned ON while the framebuffers are still properly updated. The solution is to turn ON the backlight at startup by setting the LTDC_HSYNC and VSYNC pins to <em>HIGH</em>.</p><ol start="4"><li>Navigate to the GPIO settings in the <em>System Core</em> -&gt; <em>GPIO</em> section. Look for the PINs linked to the backlight of the display and set the GPIO output level to <em>HIGH</em>. For the STM32H7B3-DK board the pins are <em>PA1</em> (User label: LCD_BL_CTRL) and <em>PA2</em> (User label: LCD_ON/OFF).</li></ol><div class="figure"><a href="/4.19/zh-CN/img/development/scenarios/running-without-rtos/set-pins-high-417.png" target="_blank"><img src="/4.19/zh-CN/img/development/scenarios/running-without-rtos/set-pins-high-417.png"></a><p>Turning the backligh ON for the STM32H7B3-DK</p></div><ol start="5"><li>Generate code from STM32CubeMX, and then generate code from TouchGFX Designer.</li></ol><h3 class="anchor anchorWithStickyNavbar_31ik" id="cleaning-the-code">Cleaning the code<a aria-hidden="true" class="hash-link" href="#cleaning-the-code" title="Direct link to heading">​</a></h3><p>STM32CubeMX and the TouchGFX Generator cannot remove potential calls of the RTOS functions if they are under &quot;USER CODE&quot; sections. It is then necessary to manually clean the code. For the STM32H7B3-DK TBS only the Touch Controller needs to be modified.</p><ol start="6"><li><p>Open the <code>STM32TouchController.cpp</code> file found under the <code>TouchGFX/target</code> folder of the project. Manually remove <code>#include &lt;cmsis_os.h&gt;</code> and <code>configASSERT(0)</code> inside the if-statement.</p></li><li><p>Remove the <code>Freertos.c</code> file in the <code>Core/src</code> folder.</p></li></ol><p>To flash your project on your board from TouchGFX Designer you will need to cleanthe <code>Makefile</code> (found under the <code>gcc</code> folder) by deleting or commenting OS related dependencies and paths. It is also needed to clean all OS related dependencies and paths in the different projects for the toolchain/IDE used.</p><p>You are now able to run your project without an OS on a project started from a TouchGFX Board Setup.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/4.19/zh-CN/docs/development/scenarios/example-gpio"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->外部事件作为触发器</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/4.19/zh-CN/docs/development/scenarios/adding-files-to-stm32cubemx-projet"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Adding files to STM32CubeMX project<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#starting-a-project-from-a-touchgfx-board-setup" class="table-of-contents__link toc-highlight">Starting a project from a TouchGFX Board Setup</a><ul><li><a href="#turning-on-the-backlight" class="table-of-contents__link toc-highlight">Turning on the backlight</a></li><li><a href="#cleaning-the-code" class="table-of-contents__link toc-highlight">Cleaning the code</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">All rights reserved © 2021 STMicroelectronics | <a href="https://www.st.com/content/st_com/en/common/terms-of-use.html">Terms of use</a> | <a href="https://www.st.com/content/st_com/en/common/privacy-policy.html">Privacy Policy</a> | <a href="/docs/miscellaneous/cookie-policy">Cookie Policy</a> | <a href="https://app-de.onetrust.com/app/#/webform/2b87200d-4023-4588-9df7-ab0cdea1a67e">Exercise your rights</a></div></div></div></footer></div>
<script src="/4.19/zh-CN/assets/js/runtime~main.72940727.js"></script>
<script src="/4.19/zh-CN/assets/js/main.f67cdb5d.js"></script>
</body>
</html>